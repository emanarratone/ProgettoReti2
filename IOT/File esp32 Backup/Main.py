import timeimport Configfrom Wifi import Wififrom Broker import MQTTBrokerfrom Sbarra import Sbarrafrom Schermo import Schermofrom Telepass import Telepassfrom GestoreBroker import GestoreBrokerfrom Setup import Setup# --- PARAMETRI ---TARGA = "DY484VY"ID_CASELLO = 4CORSIA_NUM = 1# --- INIZIALIZZAZIONE HARDWARE ---# Inizializziamo subito i componenti fisicisbarra = Sbarra(True, 0, 0, 0, pin_id=Config.SERVO_PIN)schermo = Schermo(Config.SCL_PIN, Config.SDA_PIN, Config.WIDTH, Config.HEIGHT)telepass = Telepass(Config.TELEPASS_PIN)# --- CONNESSIONE ---wifi = Wifi(Config.SSID, Config.PASSWORD)broker = MQTTBroker(Config.BROKER_IP, Config.PORT_BROKER)schermo.setText("CONNESSONE...")if not wifi.connect() or not broker.connect():    print("‚ùå Errore connessione!")    schermo.setText("ERRORE RETE")    raise SystemExit# Inizializziamo i gestori logicigestore_mqtt = GestoreBroker(broker)configuratore = Setup(gestore_mqtt, TARGA)# --- CONFIGURAZIONE ---d_veicolo, d_casello, d_corsia = configuratore.ottieni_configurazione_completa(ID_CASELLO, CORSIA_NUM)if d_corsia and d_casello:    sigla = d_casello.get('sigla')    is_chiusa = d_corsia.get('closed')    if is_chiusa:        print("‚ö†Ô∏è CORSIA CHIUSA")        schermo.setText("CHIUSO")        sbarra.close_bar()    else:        msg_benvenuto = f"BENVENUTI A"        print(f"‚úÖ Sistema attivo a {sigla}.")        schermo.setText(msg_benvenuto,sigla)        # --- LOOP OPERATIVO ---        print("üöÄ Pronto per rilevamento veicoli...")        while True:            # Utilizza il metodo non bloccante per il rilevamento            if telepass.veicolo_rilevato():                print("üöó Veicolo rilevato!")                schermo.setText("TRANSITO...\nBUON VIAGGIO")                sbarra.open_bar()                sbarra.close_bar()                print("üîí Sbarra chiusa. In attesa del prossimo veicolo.")                schermo.setText(msg_benvenuto)            time.sleep(0.05) # Delay minimo per stabilit√† CPUelse:    print("‚ùå Errore critico: Dati incompleti ricevuti dal Broker")    schermo.setText("ERR CONFIG")